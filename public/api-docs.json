{
  "openapi": "3.0.3",
  "info": {
    "title": "Restaurant Management API",
    "description": "API RESTful completa para gerenciamento de restaurantes com autenticação JWT, multi-tenancy e sistema de assinaturas",
    "version": "2.0.0",
    "contact": {
      "name": "API Support",
      "email": "support@restaurantapi.com"
    },
    "license": {
      "name": "MIT",
      "url": "https://opensource.org/licenses/MIT"
    }
  },
  "servers": [
    {
      "url": "http://localhost:8000/api",
      "description": "Development server"
    },
    {
      "url": "https://api.restaurantmanager.com/api",
      "description": "Production server"
    }
  ],
  "security": [
    {
      "bearerAuth": []
    }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "User": {
        "type": "object",
        "properties": {
          "id": {"type": "integer"},
          "restaurant_id": {"type": "integer"},
          "name": {"type": "string"},
          "email": {"type": "string", "format": "email"},
          "role": {"type": "string", "enum": ["admin", "manager", "employee", "viewer"]},
          "status": {"type": "string", "enum": ["active", "inactive", "suspended"]},
          "created_at": {"type": "string", "format": "date-time"},
          "updated_at": {"type": "string", "format": "date-time"}
        }
      },
      "Product": {
        "type": "object",
        "properties": {
          "id": {"type": "integer"},
          "restaurant_id": {"type": "integer"},
          "category_id": {"type": "integer"},
          "name": {"type": "string"},
          "description": {"type": "string"},
          "price": {"type": "number", "format": "float"},
          "cost": {"type": "number", "format": "float"},
          "stock_quantity": {"type": "integer"},
          "min_stock": {"type": "integer"},
          "sku": {"type": "string"},
          "barcode": {"type": "string"},
          "status": {"type": "string", "enum": ["active", "inactive", "out_of_stock"]},
          "is_featured": {"type": "boolean"},
          "images": {"type": "array", "items": {"type": "string"}},
          "created_at": {"type": "string", "format": "date-time"},
          "updated_at": {"type": "string", "format": "date-time"}
        }
      },
      "Order": {
        "type": "object",
        "properties": {
          "id": {"type": "integer"},
          "restaurant_id": {"type": "integer"},
          "customer_id": {"type": "integer"},
          "order_number": {"type": "string"},
          "status": {"type": "string", "enum": ["pending", "confirmed", "preparing", "ready", "delivered", "cancelled"]},
          "total_amount": {"type": "number", "format": "float"},
          "tax_amount": {"type": "number", "format": "float"},
          "discount_amount": {"type": "number", "format": "float"},
          "payment_status": {"type": "string", "enum": ["pending", "paid", "failed", "refunded"]},
          "payment_method": {"type": "string"},
          "notes": {"type": "string"},
          "items": {"type": "array", "items": {"$ref": "#/components/schemas/OrderItem"}},
          "created_at": {"type": "string", "format": "date-time"},
          "updated_at": {"type": "string", "format": "date-time"}
        }
      },
      "OrderItem": {
        "type": "object",
        "properties": {
          "id": {"type": "integer"},
          "product_id": {"type": "integer"},
          "product_name": {"type": "string"},
          "quantity": {"type": "integer"},
          "unit_price": {"type": "number", "format": "float"},
          "total_price": {"type": "number", "format": "float"},
          "notes": {"type": "string"}
        }
      },
      "Category": {
        "type": "object",
        "properties": {
          "id": {"type": "integer"},
          "restaurant_id": {"type": "integer"},
          "name": {"type": "string"},
          "description": {"type": "string"},
          "slug": {"type": "string"},
          "image": {"type": "string"},
          "sort_order": {"type": "integer"},
          "status": {"type": "string", "enum": ["active", "inactive"]},
          "created_at": {"type": "string", "format": "date-time"},
          "updated_at": {"type": "string", "format": "date-time"}
        }
      },
      "Customer": {
        "type": "object",
        "properties": {
          "id": {"type": "integer"},
          "restaurant_id": {"type": "integer"},
          "name": {"type": "string"},
          "email": {"type": "string", "format": "email"},
          "phone": {"type": "string"},
          "address": {"type": "string"},
          "city": {"type": "string"},
          "state": {"type": "string"},
          "zip_code": {"type": "string"},
          "birth_date": {"type": "string", "format": "date"},
          "status": {"type": "string", "enum": ["active", "inactive", "blocked"]},
          "total_orders": {"type": "integer"},
          "total_spent": {"type": "number", "format": "float"},
          "created_at": {"type": "string", "format": "date-time"},
          "updated_at": {"type": "string", "format": "date-time"}
        }
      },
      "AuthResponse": {
        "type": "object",
        "properties": {
          "success": {"type": "boolean"},
          "message": {"type": "string"},
          "data": {
            "type": "object",
            "properties": {
              "access_token": {"type": "string"},
              "refresh_token": {"type": "string"},
              "token_type": {"type": "string", "default": "Bearer"},
              "expires_in": {"type": "integer"},
              "user": {"$ref": "#/components/schemas/User"}
            }
          }
        }
      },
      "ApiResponse": {
        "type": "object",
        "properties": {
          "success": {"type": "boolean"},
          "message": {"type": "string"},
          "data": {"type": "object"},
          "meta": {
            "type": "object",
            "properties": {
              "pagination": {
                "type": "object",
                "properties": {
                  "current_page": {"type": "integer"},
                  "per_page": {"type": "integer"},
                  "total": {"type": "integer"},
                  "total_pages": {"type": "integer"}
                }
              }
            }
          }
        }
      },
      "ErrorResponse": {
        "type": "object",
        "properties": {
          "success": {"type": "boolean", "default": false},
          "message": {"type": "string"},
          "error_code": {"type": "string"},
          "errors": {"type": "object"},
          "timestamp": {"type": "string", "format": "date-time"}
        }
      }
    }
  },
  "paths": {
    "/auth/login": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Login do usuário",
        "description": "Autentica um usuário e retorna tokens JWT",
        "security": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["email", "password"],
                "properties": {
                  "email": {"type": "string", "format": "email"},
                  "password": {"type": "string", "minLength": 6},
                  "remember_me": {"type": "boolean", "default": false}
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Login realizado com sucesso",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/AuthResponse"}
              }
            }
          },
          "401": {
            "description": "Credenciais inválidas",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ErrorResponse"}
              }
            }
          }
        }
      }
    },
    "/auth/register": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Registro de novo usuário",
        "description": "Registra um novo usuário no sistema",
        "security": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["name", "email", "password", "restaurant_name"],
                "properties": {
                  "name": {"type": "string"},
                  "email": {"type": "string", "format": "email"},
                  "password": {"type": "string", "minLength": 6},
                  "password_confirm": {"type": "string"},
                  "restaurant_name": {"type": "string"},
                  "phone": {"type": "string"}
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Usuário registrado com sucesso",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/AuthResponse"}
              }
            }
          },
          "422": {
            "description": "Dados de validação inválidos",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ErrorResponse"}
              }
            }
          }
        }
      }
    },
    "/auth/refresh": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Renovar token de acesso",
        "description": "Renova o token de acesso usando o refresh token",
        "security": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["refresh_token"],
                "properties": {
                  "refresh_token": {"type": "string"}
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Token renovado com sucesso",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/AuthResponse"}
              }
            }
          },
          "401": {
            "description": "Refresh token inválido",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ErrorResponse"}
              }
            }
          }
        }
      }
    },
    "/auth/logout": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Logout do usuário",
        "description": "Invalida o token atual do usuário",
        "responses": {
          "200": {
            "description": "Logout realizado com sucesso",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ApiResponse"}
              }
            }
          }
        }
      }
    },
    "/auth/me": {
      "get": {
        "tags": ["Authentication"],
        "summary": "Informações do usuário atual",
        "description": "Retorna informações do usuário autenticado",
        "responses": {
          "200": {
            "description": "Informações do usuário",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {"$ref": "#/components/schemas/ApiResponse"},
                    {
                      "type": "object",
                      "properties": {
                        "data": {"$ref": "#/components/schemas/User"}
                      }
                    }
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/users": {
      "get": {
        "tags": ["Users"],
        "summary": "Listar usuários",
        "description": "Retorna lista paginada de usuários",
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "schema": {"type": "integer", "default": 1}
          },
          {
            "name": "per_page",
            "in": "query",
            "schema": {"type": "integer", "default": 20, "maximum": 100}
          },
          {
            "name": "search",
            "in": "query",
            "schema": {"type": "string"}
          },
          {
            "name": "role",
            "in": "query",
            "schema": {"type": "string", "enum": ["admin", "manager", "employee", "viewer"]}
          },
          {
            "name": "status",
            "in": "query",
            "schema": {"type": "string", "enum": ["active", "inactive", "suspended"]}
          }
        ],
        "responses": {
          "200": {
            "description": "Lista de usuários",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {"$ref": "#/components/schemas/ApiResponse"},
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "type": "array",
                          "items": {"$ref": "#/components/schemas/User"}
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Users"],
        "summary": "Criar novo usuário",
        "description": "Cria um novo usuário no sistema",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["name", "email", "password", "role"],
                "properties": {
                  "name": {"type": "string"},
                  "email": {"type": "string", "format": "email"},
                  "password": {"type": "string", "minLength": 6},
                  "role": {"type": "string", "enum": ["admin", "manager", "employee", "viewer"]},
                  "phone": {"type": "string"},
                  "status": {"type": "string", "enum": ["active", "inactive"], "default": "active"}
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Usuário criado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {"$ref": "#/components/schemas/ApiResponse"},
                    {
                      "type": "object",
                      "properties": {
                        "data": {"$ref": "#/components/schemas/User"}
                      }
                    }
                  ]
                }
              }
            }
          },
          "422": {
            "description": "Dados de validação inválidos",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ErrorResponse"}
              }
            }
          }
        }
      }
    },
    "/users/{id}": {
      "get": {
        "tags": ["Users"],
        "summary": "Obter usuário por ID",
        "description": "Retorna informações de um usuário específico",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {"type": "integer"}
          }
        ],
        "responses": {
          "200": {
            "description": "Informações do usuário",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {"$ref": "#/components/schemas/ApiResponse"},
                    {
                      "type": "object",
                      "properties": {
                        "data": {"$ref": "#/components/schemas/User"}
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Usuário não encontrado",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ErrorResponse"}
              }
            }
          }
        }
      },
      "put": {
        "tags": ["Users"],
        "summary": "Atualizar usuário",
        "description": "Atualiza informações de um usuário",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {"type": "integer"}
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {"type": "string"},
                  "email": {"type": "string", "format": "email"},
                  "role": {"type": "string", "enum": ["admin", "manager", "employee", "viewer"]},
                  "phone": {"type": "string"},
                  "status": {"type": "string", "enum": ["active", "inactive", "suspended"]}
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Usuário atualizado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {"$ref": "#/components/schemas/ApiResponse"},
                    {
                      "type": "object",
                      "properties": {
                        "data": {"$ref": "#/components/schemas/User"}
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Usuário não encontrado",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ErrorResponse"}
              }
            }
          },
          "422": {
            "description": "Dados de validação inválidos",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ErrorResponse"}
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["Users"],
        "summary": "Excluir usuário",
        "description": "Remove um usuário do sistema",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {"type": "integer"}
          }
        ],
        "responses": {
          "200": {
            "description": "Usuário excluído com sucesso",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ApiResponse"}
              }
            }
          },
          "404": {
            "description": "Usuário não encontrado",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ErrorResponse"}
              }
            }
          }
        }
      }
    },
    "/products": {
      "get": {
        "tags": ["Products"],
        "summary": "Listar produtos",
        "description": "Retorna lista paginada de produtos",
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "schema": {"type": "integer", "default": 1}
          },
          {
            "name": "per_page",
            "in": "query",
            "schema": {"type": "integer", "default": 20, "maximum": 100}
          },
          {
            "name": "search",
            "in": "query",
            "schema": {"type": "string"}
          },
          {
            "name": "category_id",
            "in": "query",
            "schema": {"type": "integer"}
          },
          {
            "name": "status",
            "in": "query",
            "schema": {"type": "string", "enum": ["active", "inactive", "out_of_stock"]}
          },
          {
            "name": "is_featured",
            "in": "query",
            "schema": {"type": "boolean"}
          }
        ],
        "responses": {
          "200": {
            "description": "Lista de produtos",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {"$ref": "#/components/schemas/ApiResponse"},
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "type": "array",
                          "items": {"$ref": "#/components/schemas/Product"}
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Products"],
        "summary": "Criar novo produto",
        "description": "Cria um novo produto no sistema",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["name", "price", "category_id"],
                "properties": {
                  "name": {"type": "string"},
                  "description": {"type": "string"},
                  "price": {"type": "number", "format": "float", "minimum": 0},
                  "cost": {"type": "number", "format": "float", "minimum": 0},
                  "category_id": {"type": "integer"},
                  "stock_quantity": {"type": "integer", "minimum": 0},
                  "min_stock": {"type": "integer", "minimum": 0},
                  "sku": {"type": "string"},
                  "barcode": {"type": "string"},
                  "status": {"type": "string", "enum": ["active", "inactive"], "default": "active"},
                  "is_featured": {"type": "boolean", "default": false},
                  "images": {"type": "array", "items": {"type": "string"}}
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Produto criado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {"$ref": "#/components/schemas/ApiResponse"},
                    {
                      "type": "object",
                      "properties": {
                        "data": {"$ref": "#/components/schemas/Product"}
                      }
                    }
                  ]
                }
              }
            }
          },
          "422": {
            "description": "Dados de validação inválidos",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ErrorResponse"}
              }
            }
          }
        }
      }
    },
    "/orders": {
      "get": {
        "tags": ["Orders"],
        "summary": "Listar pedidos",
        "description": "Retorna lista paginada de pedidos",
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "schema": {"type": "integer", "default": 1}
          },
          {
            "name": "per_page",
            "in": "query",
            "schema": {"type": "integer", "default": 20, "maximum": 100}
          },
          {
            "name": "status",
            "in": "query",
            "schema": {"type": "string", "enum": ["pending", "confirmed", "preparing", "ready", "delivered", "cancelled"]}
          },
          {
            "name": "customer_id",
            "in": "query",
            "schema": {"type": "integer"}
          },
          {
            "name": "date_from",
            "in": "query",
            "schema": {"type": "string", "format": "date"}
          },
          {
            "name": "date_to",
            "in": "query",
            "schema": {"type": "string", "format": "date"}
          }
        ],
        "responses": {
          "200": {
            "description": "Lista de pedidos",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {"$ref": "#/components/schemas/ApiResponse"},
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "type": "array",
                          "items": {"$ref": "#/components/schemas/Order"}
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Orders"],
        "summary": "Criar novo pedido",
        "description": "Cria um novo pedido no sistema",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["customer_id", "items"],
                "properties": {
                  "customer_id": {"type": "integer"},
                  "payment_method": {"type": "string"},
                  "notes": {"type": "string"},
                  "discount_amount": {"type": "number", "format": "float", "minimum": 0},
                  "items": {
                    "type": "array",
                    "minItems": 1,
                    "items": {
                      "type": "object",
                      "required": ["product_id", "quantity"],
                      "properties": {
                        "product_id": {"type": "integer"},
                        "quantity": {"type": "integer", "minimum": 1},
                        "unit_price": {"type": "number", "format": "float"},
                        "notes": {"type": "string"}
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Pedido criado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {"$ref": "#/components/schemas/ApiResponse"},
                    {
                      "type": "object",
                      "properties": {
                        "data": {"$ref": "#/components/schemas/Order"}
                      }
                    }
                  ]
                }
              }
            }
          },
          "422": {
            "description": "Dados de validação inválidos",
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/ErrorResponse"}
              }
            }
          }
        }
      }
    },
    "/analytics/dashboard": {
      "get": {
        "tags": ["Analytics"],
        "summary": "Dashboard de analytics",
        "description": "Retorna métricas principais do dashboard",
        "parameters": [
          {
            "name": "period",
            "in": "query",
            "schema": {"type": "string", "enum": ["today", "week", "month", "quarter", "year"], "default": "month"}
          },
          {
            "name": "date_from",
            "in": "query",
            "schema": {"type": "string", "format": "date"}
          },
          {
            "name": "date_to",
            "in": "query",
            "schema": {"type": "string", "format": "date"}
          }
        ],
        "responses": {
          "200": {
            "description": "Métricas do dashboard",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {"$ref": "#/components/schemas/ApiResponse"},
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "type": "object",
                          "properties": {
                            "total_revenue": {"type": "number", "format": "float"},
                            "total_orders": {"type": "integer"},
                            "total_customers": {"type": "integer"},
                            "average_order_value": {"type": "number", "format": "float"},
                            "revenue_growth": {"type": "number", "format": "float"},
                            "orders_growth": {"type": "number", "format": "float"},
                            "top_products": {
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "product_name": {"type": "string"},
                                  "quantity_sold": {"type": "integer"},
                                  "revenue": {"type": "number", "format": "float"}
                                }
                              }
                            },
                            "revenue_chart": {
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "date": {"type": "string", "format": "date"},
                                  "revenue": {"type": "number", "format": "float"},
                                  "orders": {"type": "integer"}
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/public/health": {
      "get": {
        "tags": ["System"],
        "summary": "Health check da API",
        "description": "Verifica o status de saúde da API",
        "security": [],
        "responses": {
          "200": {
            "description": "API funcionando corretamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {"type": "string", "example": "healthy"},
                    "timestamp": {"type": "string", "format": "date-time"},
                    "version": {"type": "string", "example": "2.0.0"},
                    "uptime": {"type": "integer"},
                    "database": {"type": "string", "example": "connected"},
                    "cache": {"type": "string", "example": "connected"}
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "tags": [
    {
      "name": "Authentication",
      "description": "Endpoints de autenticação e autorização"
    },
    {
      "name": "Users",
      "description": "Gerenciamento de usuários"
    },
    {
      "name": "Products",
      "description": "Gerenciamento de produtos"
    },
    {
      "name": "Orders",
      "description": "Gerenciamento de pedidos"
    },
    {
      "name": "Categories",
      "description": "Gerenciamento de categorias"
    },
    {
      "name": "Customers",
      "description": "Gerenciamento de clientes"
    },
    {
      "name": "Analytics",
      "description": "Métricas e relatórios analíticos"
    },
    {
      "name": "System",
      "description": "Endpoints do sistema"
    }
  ]
}